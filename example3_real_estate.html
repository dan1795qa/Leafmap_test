<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèòÔ∏è –ü—Ä–∏–º–µ—Ä 3: –ü–æ–∏—Å–∫ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
        }
        
        .wrapper {
            display: flex;
            height: 100vh;
        }
        
        .sidebar {
            width: 320px;
            background: white;
            box-shadow: 2px 0 8px rgba(0,0,0,0.1);
            overflow-y: auto;
            padding: 15px;
        }
        
        .map-container {
            flex: 1;
            position: relative;
        }
        
        #map {
            width: 100%;
            height: 100%;
        }
        
        .sidebar h2 {
            color: #2196F3;
            font-size: 16px;
            margin-bottom: 15px;
            border-bottom: 2px solid #2196F3;
            padding-bottom: 8px;
        }
        
        .filter-group {
            margin-bottom: 15px;
        }
        
        .filter-label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #666;
            margin-bottom: 6px;
        }
        
        .filter-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
        }
        
        .btn {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn-primary {
            background: #2196F3;
            color: white;
        }
        
        .btn-primary:hover {
            background: #1976D2;
        }
        
        .results {
            margin-top: 15px;
        }
        
        .results-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 13px;
        }
        
        .result-item {
            background: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .result-item:hover {
            border-color: #2196F3;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.2);
        }
        
        .result-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }
        
        .result-type {
            display: inline-block;
            padding: 2px 6px;
            background: #e3f2fd;
            color: #1976D2;
            border-radius: 3px;
            font-size: 11px;
            margin-bottom: 4px;
        }
        
        .result-price {
            font-size: 12px;
            color: #4CAF50;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <div class="sidebar">
            <h2>üîç –ü–æ–∏—Å–∫ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</h2>
            
            <div class="filter-group">
                <label class="filter-label">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                <input type="text" id="searchName" class="filter-input" placeholder="–ö–≤–∞—Ä—Ç–∏—Ä–∞, –¥–æ–º...">
            </div>
            
            <div class="filter-group">
                <label class="filter-label">–¢–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏:</label>
                <select id="propertyType" class="filter-input">
                    <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                    <option value="–ö–≤–∞—Ä—Ç–∏—Ä–∞">–ö–≤–∞—Ä—Ç–∏—Ä–∞</option>
                    <option value="–î–æ–º">–î–æ–º</option>
                    <option value="–û—Ñ–∏—Å">–û—Ñ–∏—Å</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label">–ú–∞–∫—Å. —Ü–µ–Ω–∞ ($):</label>
                <input type="number" id="maxPrice" class="filter-input" placeholder="500000">
            </div>
            
            <button class="btn btn-primary" onclick="searchProperties()">üîé –ü–æ–∏—Å–∫</button>
            
            <div class="results">
                <div class="results-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</div>
                <div id="resultsList"></div>
            </div>
        </div>
        
        <div class="map-container">
            <div id="map"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
        const map = L.map('map').setView([53.9045, 27.5615], 13);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);
        
        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
        const properties = [
            {
                id: 1,
                name: '–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞',
                type: '–ö–≤–∞—Ä—Ç–∏—Ä–∞',
                price: 250000,
                lat: 53.9045,
                lng: 27.5615,
                rooms: 2,
                area: 65,
                description: '–ö–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞'
            },
            {
                id: 2,
                name: '–£—é—Ç–Ω—ã–π –¥–æ–º',
                type: '–î–æ–º',
                price: 450000,
                lat: 53.9100,
                lng: 27.5600,
                rooms: 4,
                area: 180,
                description: '–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –¥–æ–º —Å —Å–∞–¥–æ–º'
            },
            {
                id: 3,
                name: '–ë–∏–∑–Ω–µ—Å –æ—Ñ–∏—Å',
                type: '–û—Ñ–∏—Å',
                price: 150000,
                lat: 53.9200,
                lng: 27.5500,
                rooms: 1,
                area: 40,
                description: '–û—Ñ–∏—Å –¥–ª—è –Ω–µ–±–æ–ª—å—à–æ–π –∫–æ–º–ø–∞–Ω–∏–∏'
            },
            {
                id: 4,
                name: '–õ—é–∫—Å –∫–≤–∞—Ä—Ç–∏—Ä–∞',
                type: '–ö–≤–∞—Ä—Ç–∏—Ä–∞',
                price: 350000,
                lat: 53.8900,
                lng: 27.5400,
                rooms: 3,
                area: 95,
                description: '–ü—Ä–µ–º–∏—É–º –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å –≤–∏–¥–æ–º –Ω–∞ –≥–æ—Ä–æ–¥'
            },
            {
                id: 5,
                name: '–ü—Ä–æ—Å—Ç–æ—Ä–Ω—ã–π –¥–æ–º',
                type: '–î–æ–º',
                price: 500000,
                lat: 53.9300,
                lng: 27.5700,
                rooms: 5,
                area: 250,
                description: '–ë–æ–ª—å—à–æ–π –¥–æ–º –¥–ª—è –±–æ–ª—å—à–æ–π —Å–µ–º—å–∏'
            },
            {
                id: 6,
                name: '–°—Ç–∞—Ä—Ç–∞–ø –æ—Ñ–∏—Å',
                type: '–û—Ñ–∏—Å',
                price: 120000,
                lat: 53.8950,
                lng: 27.5550,
                rooms: 2,
                area: 60,
                description: '–°–≤–µ–∂–∏–π –æ—Ñ–∏—Å —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º'
            }
        ];
        
        // –ú–∞—Ä–∫–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç–µ
        const markers = {};
        const colors = {
            '–ö–≤–∞—Ä—Ç–∏—Ä–∞': '#2196F3',
            '–î–æ–º': '#4CAF50',
            '–û—Ñ–∏—Å': '#FF9800'
        };
        
        // –°–æ–∑–¥–∞—Ç—å –∏–∫–æ–Ω–∫—É –º–∞—Ä–∫–µ—Ä–∞
        function createIcon(type) {
            const color = colors[type] || '#666';
            return L.divIcon({
                html: `<div style="
                    width: 30px;
                    height: 30px;
                    background: ${color};
                    border-radius: 50%;
                    border: 2px solid white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-weight: bold;
                    font-size: 16px;
                    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                ">üí∞</div>`,
                iconSize: [30, 30],
                className: 'custom-marker'
            });
        }
        
        // –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä–∫–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç—É
        function addMarkers(propertiesToShow) {
            // –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –º–∞—Ä–∫–µ—Ä—ã
            Object.values(markers).forEach(marker => map.removeLayer(marker));
            markers = {};
            
            // –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –º–∞—Ä–∫–µ—Ä—ã
            propertiesToShow.forEach(prop => {
                const marker = L.marker([prop.lat, prop.lng], {
                    icon: createIcon(prop.type)
                }).bindPopup(`
                    <div style="width: 200px;">
                        <h3>${prop.name}</h3>
                        <p><b>–¢–∏–ø:</b> ${prop.type}</p>
                        <p><b>–¶–µ–Ω–∞:</b> $${prop.price.toLocaleString()}</p>
                        <p><b>–ü–ª–æ—â–∞–¥—å:</b> ${prop.area} –º¬≤</p>
                        <p><b>–ö–æ–º–Ω–∞—Ç:</b> ${prop.rooms}</p>
                        <p><i>${prop.description}</i></p>
                    </div>
                `).addTo(map);
                
                marker.on('click', function() {
                    this.openPopup();
                });
                
                markers[prop.id] = marker;
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞
        function searchProperties() {
            const name = document.getElementById('searchName').value.toLowerCase();
            const type = document.getElementById('propertyType').value;
            const maxPrice = parseInt(document.getElementById('maxPrice').value) || Infinity;
            
            const filtered = properties.filter(prop => {
                const nameMatch = prop.name.toLowerCase().includes(name);
                const typeMatch = !type || prop.type === type;
                const priceMatch = prop.price <= maxPrice;
                return nameMatch && typeMatch && priceMatch;
            });
            
            // –û–±–Ω–æ–≤–∏—Ç—å –º–∞—Ä–∫–µ—Ä—ã
            addMarkers(filtered);
            
            // –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            displayResults(filtered);
            
            // –ü–æ–¥–æ–≥–Ω–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã
            if (filtered.length > 0) {
                const bounds = L.latLngBounds(filtered.map(p => [p.lat, p.lng]));
                map.fitBounds(bounds, {padding: [50, 50]});
            }
        }
        
        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Å–ø–∏—Å–∫–µ
        function displayResults(filtered) {
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '';
            
            if (filtered.length === 0) {
                resultsList.innerHTML = '<div class="result-item">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                return;
            }
            
            filtered.forEach(prop => {
                const div = document.createElement('div');
                div.className = 'result-item';
                div.innerHTML = `
                    <div class="result-name">${prop.name}</div>
                    <span class="result-type">${prop.type}</span>
                    <div class="result-price">$${prop.price.toLocaleString()}</div>
                `;
                
                div.onclick = () => {
                    map.setView([prop.lat, prop.lng], 16);
                    markers[prop.id].openPopup();
                };
                
                resultsList.appendChild(div);
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
        addMarkers(properties);
        displayResults(properties);
    </script>
</body>
</html>